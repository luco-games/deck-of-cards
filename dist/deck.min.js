"use strict";var Deck=function(){function n(n){return document.createElement(n)}function t(n,t){var o=Date.now(),r=o+n,i=r+t,u={start:r,end:i};h.push(u),v||(v=!0,requestAnimationFrame(e));var a={start:function(n){return u.startcb=n,a},progress:function(n){return u.progresscb=n,a},end:function(n){return u.endcb=n,a}};return a}function e(){var n=Date.now();if(!h.length)return void(v=!1);for(var t,o=0;o<h.length;o++)if(t=h[o],!(n<t.start)){t.started||(t.started=!0,t.startcb&&t.startcb());var r=(n-t.start)/(t.end-t.start);t.progresscb&&t.progresscb(r<1?r:1),n>t.end&&(t.endcb&&t.endcb(),h.splice(o--,1))}requestAnimationFrame(e)}function o(){return window.getComputedStyle(document.body).getPropertyValue("font-size").slice(0,-2)}function r(n){return n*Math.PI/180}function i(n){if(void 0!==C[n])return C[n];if(void 0!==q[n])return C[n]=n,n;for(var t,e=n[0].toUpperCase()+n.slice(1),o=["webkit","moz","Moz","ms","o"],r=0,i=o.length;r<i;r++)if(t=o[r]+e,void 0!==q[t])return C[n]=t,t}function u(n,t,e){return void 0!==g||(g=a()),e=e||0,g?"translate3d("+n+", "+t+", "+e+")":"translate("+n+", "+t+")"}function a(){if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))return!1;var n=i("transform"),t=document.createElement("p");return document.body.appendChild(t),t.style[n]="translate3d(1px,1px,1px)",g=t.style[n],g=null!=g&&g.length&&"none"!==g,document.body.removeChild(t),g}function c(n){for(var t,e,o=n.length-1;o;o--)t=Math.floor(Math.random()*(o+1)),e=n[o],n[o]=n[t],n[t]=e;return n}function s(n){return(Math.round(Math.random())?-1:1)*n}function d(n){function t(n,t,e){i[n]||(i[n]=[]),i[n].push({cb:t,ctx:e})}function e(n,t,e){i[n]||(i[n]=[]),i[n].push({cb:t,ctx:e,once:!0})}function o(n){var t=this,e=Array.prototype.slice(arguments,1);(i[n]||[]).filter(function(n){return n.cb.apply(t,e),!n.once})}function r(n,t){return n?t?void(i[n]=i[n].filter(function(n){return n.cb!==t})):void(i[n]=[]):void(i={})}n||(n={});var i={};return n.on=t,n.one=e,n.off=r,n.trigger=o,n}function f(n){function t(n){return function(){var t=this,o=arguments;e(function(e){n.apply(t,r.concat.apply(e,o))})}}function e(n){n&&(i.push(n),1===i.length&&o())}function o(){i[0](function(n){if(n)throw n;i=i.slice(1),i.length&&o()})}var r=Array.prototype,i=[];return n.queue=e,n.queued=t,n}function l(e){function o(n){n.preventDefault()}function r(n){function t(n){b&&("mousemove"===n.type?(r.x=n.clientX,r.y=n.clientY):(r.x=n.touches[0].clientX,r.y=n.touches[0].clientY),h.style[f]=u(Math.round(q.x+r.x-o.x)+"px",Math.round(q.y+r.y-o.y)+"px")+(q.rot?" rotate("+q.rot+"deg)":"")+" scale("+q.scale+")")}function e(n){k&&1===n.which&&Date.now()-i<200&&q.setSide("front"===q.side?"back":"front"),"mouseup"===n.type?(m(window,"mousemove",t),m(window,"mouseup",e)):(m(window,"touchmove",t),m(window,"touchend",e)),b&&(q.x=q.x+r.x-o.x,q.y=q.y+r.y-o.y)}var o={},r={},i=Date.now();if(n.preventDefault(),3===n.which)return 1===q.scale&&(q.scaleLimit=!1),5===q.scale&&(q.scaleLimit=!0),q.scaleLimit?q.scale-=1:q.scale+=1,void(h.style[f]=u(q.x+"px",q.y+"px")+(q.rot?" rotate("+q.rot+"deg)":"")+" scale("+q.scale+")");"mousedown"===n.type?(o.x=r.x=n.clientX,o.y=r.y=n.clientY,p(window,"mousemove",t),p(window,"mouseup",e)):(o.x=r.x=n.touches[0].clientX,o.y=r.y=n.touches[0].clientY,p(window,"touchmove",t),p(window,"touchend",e)),b&&(h.style[f]=u(q.x+"px",q.y+"px")+(q.rot?" rotate("+q.rot+"deg)":"")+" scale("+q.scale+")",h.style.zIndex=O++)}function a(n){n.appendChild(h),q.$root=n}function c(){q.$root&&q.$root.removeChild(h),q.$root=null}function s(n){"front"===n?("back"===q.side&&h.removeChild(g),q.side="front",h.appendChild(x),q.setRank(q.rank)):("front"===q.side&&h.removeChild(x),q.side="back",h.appendChild(g))}var d,f=i("transform"),l=e,v=(O-e)/4,h=n("div"),x=n("div"),g=n("div"),b=!1,k=!1,q={i:e,rank:l,pos:e,$el:h,mount:a,unmount:c,setSide:s},C=y.modules;x.classList.add("face"),g.classList.add("back"),h.style[f]=u(-v+"px",-v+"px"),q.x=-v,q.y=-v,q.z=v,q.rot=0,q.scale=1,q.scaleLimit=!1,q.setSide("back"),p(h,"mousedown",r),p(h,"touchstart",r),p(h,"contextmenu",o);for(d in C)!function(n){n.card&&n.card(q)}(C[d]);return q.animateTo=function(n){var e,o,r,i,a,c,s=n.delay,d=n.duration,l=n.x,p=void 0===l?q.x:l,m=n.y,y=void 0===m?q.y:m,v=n.rot,x=void 0===v?q.rot:v,g=n.ease,b=n.onStart,k=n.onProgress,C=n.onComplete;t(s,d).start(function(){e=q.x||0,o=q.y||0,r=q.rot||0,b&&b()}).progress(function(n){var t=w[g||"cubicInOut"](n);i=p-e,a=y-o,c=x-r,k&&k(n,t),q.x=e+i*t,q.y=o+a*t,q.rot=r+c*t,h.style[f]=u(q.x+"px",q.y+"px")+(c?"rotate("+q.rot+"deg)":"")}).end(function(){C&&C()})},q.setRank=function(n){h.setAttribute("class","card rank"+n)},q.setRank(l),q.enableDragging=function(){b||(b=!0,h.style.cursor="move")},q.enableFlipping=function(){k||(k=!0)},q.disableFlipping=function(){k&&(k=!1)},q.disableDragging=function(){b&&(b=!1,h.style.cursor="")},q}function p(n,t,e){n.addEventListener(t,e)}function m(n,t,e){n.removeEventListener(t,e)}function y(t){function e(n){r=n,r.appendChild(a)}function o(){r.removeChild(a)}var r,i,u=new Array(t),a=n("div"),c=d({mount:e,unmount:o,cards:u,$el:a}),s=y.modules;f(c);for(i in s)!function(n){n.deck&&n.deck(c)}(s[i]);a.classList.add("deck");for(var p,m=u.length;m;m--)p=u[m-1]=l(m-1),p.setSide("back"),p.mount(a);return c}var v,h=[];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){setTimeout(n,0)});var x,g,b,w={linear:function(n){return n},quadIn:function(n){return n*n},quadOut:function(n){return n*(2-n)},quadInOut:function(n){return n<.5?2*n*n:(4-2*n)*n-1},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},quartIn:function(n){return n*n*n*n},quartOut:function(n){return 1- --n*n*n*n},quartInOut:function(n){return n<.5?8*n*n*n*n:1-8*--n*n*n*n},quintIn:function(n){return n*n*n*n*n},quintOut:function(n){return 1+--n*n*n*n*n},quintInOut:function(n){return n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n}},k={deck:function(n){function t(t){var e=n.cards,r=e.length;x=o(),e.forEach(function(n,o){n.fan(o,r,function(n){n===e.length-1&&t()})})}n.fan=n.queued(t)},card:function(n){var t=n.$el;n.fan=function(e,o,i){var u=e/4,a=10*e,c=e/(o-1)*260-130;n.animateTo({delay:a,duration:300,x:-u,y:-u,rot:0}),n.animateTo({delay:300+a,duration:300,x:55*Math.cos(r(c-90))*x/16,y:55*Math.sin(r(c-90))*x/16,rot:c,onStart:function(){t.style.zIndex=e},onComplete:function(){i(e)}})}}},q=document.createElement("p").style,C={},I={deck:function(n){function e(e){var o=n.cards;o.forEach(function(n,r){n.setSide("front"),n.intro(r,function(r){t(250,0).start(function(){n.setSide("back")}),r===o.length-1&&e()})})}n.intro=n.queued(e)},card:function(n){var t=i("transform"),e=n.$el;n.intro=function(o,r){var i=500+10*o,a=o/4;e.style[t]=u(-a+"px","-250px"),e.style.opacity=0,n.x=-a,n.y=-250-a,n.rot=0,n.animateTo({delay:i,duration:1e3,x:-a,y:-a,onStart:function(){e.style.zIndex=o},onProgress:function(n){e.style.opacity=n},onComplete:function(){e.style.opacity="",r&&r(o)}})}}},M={deck:function(n){function t(t){var e=n.cards;b=o(),c(e),e.forEach(function(n,o){n.pos=o,n.shuffle(function(n){n===e.length-1&&t()})})}n.shuffle=n.queued(t)},card:function(n){var t=n.$el;n.shuffle=function(e){var o=n.pos,r=o/4,i=2*o;n.animateTo({delay:i,duration:200,x:s(40*Math.random()+20)*b/16,y:-r,rot:0}),n.animateTo({delay:200+i,duration:200,x:-r,y:-r,rot:0,onStart:function(){t.style.zIndex=o},onComplete:function(){e(o)}})}}},S={deck:function(n){function t(t,e){var o=n.cards;o.sort(function(n,t){return e?n.i-t.i:t.i-n.i}),o.forEach(function(n,r){n.sort(r,o.length,function(n){n===o.length-1&&t()},e)})}n.sort=n.queued(t)},card:function(n){var t=n.$el;n.sort=function(e,o,r,i){var u=e/4,a=10*e;n.animateTo({delay:a,duration:400,x:-u,y:-150,rot:0,onComplete:function(){t.style.zIndex=e}}),n.animateTo({delay:a+500,duration:400,x:-u,y:-u,rot:0,onComplete:function(){r(e)}})}}},E={deck:function(n){function t(t,e){var o=n.cards.filter(function(n){return"front"===n.side}).length/n.cards.length;n.cards.forEach(function(n,t){n.setSide(e||(o>.5?"back":"front"))}),t()}n.flip=n.queued(t)}},O=999;return y.animationFrames=t,y.ease=w,y.modules={fan:k,intro:I,shuffle:M,sort:S,flip:E},y.Card=l,y.prefix=i,y.translate=u,y}();